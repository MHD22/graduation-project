{"ast":null,"code":"import _classCallCheck from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Component}from'react';import{Col,Row}from'react-bootstrap';import AddStudents from'./AddStudents';import Swal from'sweetalert2';import'../css/CreateClass.css';import'../css/table.css';import'../css/myClasses.css';var EditClass=/*#__PURE__*/function(_Component){_inherits(EditClass,_Component);var _super=_createSuper(EditClass);function EditClass(){var _this;_classCallCheck(this,EditClass);_this=_super.call(this);_this.renderTable=function(students){var rows=students.map(function(std){return/*#__PURE__*/React.createElement(\"tr\",{id:\"r\".concat(std.id),key:std.id},/*#__PURE__*/React.createElement(\"td\",null,std.id),/*#__PURE__*/React.createElement(\"td\",null,std.name),/*#__PURE__*/React.createElement(\"td\",{onClick:function onClick(){return _this.deleteStd(std.id);}},/*#__PURE__*/React.createElement(\"i\",{class:\"icon-delete fas fa-user-times\"})));});_this.setState({rows:rows});};_this.deleteStd=function(id){var swalWithBootstrapButtons=Swal.mixin({customClass:{confirmButton:'btn btn-success',cancelButton:'btn btn-danger'},buttonsStyling:false});swalWithBootstrapButtons.fire({title:'Are you sure?',text:\"You want to delete this student\",icon:'warning',showCancelButton:true,confirmButtonText:'Yes, delete it!',cancelButtonText:'No, cancel!',reverseButtons:true}).then(function(result){if(result.isConfirmed){var changedList=[].concat(_this.state.lastStateOfStudents);var lastStateOfStudents=changedList.length?changedList:[].concat(_this.state.students);lastStateOfStudents=lastStateOfStudents.filter(function(std){return std.id!==id;});var rows=_this.state.rows;rows=rows.filter(function(std){return std.key!==id;});_this.setState({rows:rows,isThereChanges:true,lastStateOfStudents:lastStateOfStudents});swalWithBootstrapButtons.fire('Deleted!','Student has been deleted.','success');}else if(result.dismiss===Swal.DismissReason.cancel){swalWithBootstrapButtons.fire('Cancelled','No changes done','error');}});};_this.addStd=function(arr){var changedList=[].concat(_this.state.lastStateOfStudents);var lastStateOfStudents=changedList.length?changedList:[].concat(_this.state.students);var idsOfCurrentStudents=lastStateOfStudents.map(function(obj){return obj.id;}).join(' ');var isThereChanges=_this.state.isThereChanges;arr.forEach(function(std){if(!idsOfCurrentStudents.includes(std.id)){lastStateOfStudents.push(std);_this.renderTable(lastStateOfStudents);isThereChanges=true;}});_this.setState({clickedAdd:false,isThereChanges:isThereChanges,lastStateOfStudents:lastStateOfStudents});};_this.onAddStd=function(){_this.setState({clickedAdd:true});};_this.onDeleteClass=function(){Swal.fire({title:'Are you sure?',html:\"<h5 class='text-danger'>You want to delete this class</h5>\",icon:'warning',showCancelButton:true,confirmButtonColor:'#3085d6',cancelButtonColor:'#d33',confirmButtonText:'Yes, delete it!'}).then(function(result){if(result.isConfirmed){var classData={className:_this.props.classInfo.className};var baseUrl=document.getElementById('baseUrl').defaultValue;var url=\"\".concat(baseUrl,\"/deleteClass\");var requestOptions={method:'DELETE',headers:{'Content-Type':'application/json'},body:JSON.stringify(classData)};fetch(url,requestOptions).then(function(res){return res.json();}).then(console.log).catch(function(e){console.log(\"error on Delete class request..\",e);});_this.props.onChangeRoute('/show',500);Swal.fire('Deleted!','Class has been deleted.','success');}});};_this.onConfirm=function(){Swal.fire({title:'Do you want to save the changes?',showDenyButton:true,showCancelButton:true,confirmButtonText:\"Save\",denyButtonText:\"Don't save\",icon:'info'}).then(function(result){if(result.isConfirmed){var classData={className:_this.props.classInfo.className,students:_this.state.lastStateOfStudents};var baseUrl=document.getElementById('baseUrl').defaultValue;var url=\"\".concat(baseUrl,\"/editClass\");var requestOptions={method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(classData)};fetch(url,requestOptions).then(function(res){return res.json();}).then(console.log).catch(function(e){console.log(\"error on edit class request..\",e);});_this.setState({isThereChanges:false,lastStateOfStudents:[]});_this.props.onChangeRoute('/show',500);Swal.fire('Saved!','','success');}else if(result.isDenied){_this.onCancel();Swal.fire('Changes are not saved','','info');}});};_this.onCancel=function(){_this.renderTable(_this.state.students);_this.setState({isThereChanges:false,lastStateOfStudents:[]});};_this.back=function(){_this.setState({});_this.props.onChangeRoute('/show/classData',0);};_this.state={rows:[],clickedAdd:false,isThereChanges:false,students:[],lastStateOfStudents:[]};return _this;}_createClass(EditClass,[{key:\"componentDidMount\",value:function componentDidMount(){var students=[].concat(this.props.classInfo.students);this.renderTable(students);this.setState({students:students});}},{key:\"render\",value:function render(){var rows=this.state.rows;return/*#__PURE__*/React.createElement(\"div\",{id:\"edit-class1\",className:\"edit-class\"},/*#__PURE__*/React.createElement(\"div\",{className:\"js\"},/*#__PURE__*/React.createElement(\"button\",{\"hover-data\":\"Back\",onClick:this.back,className:\"red-btn my-button\"},/*#__PURE__*/React.createElement(\"i\",{className:\"btn-icon far fa-arrow-alt-circle-left\"}))),/*#__PURE__*/React.createElement(\"h2\",{className:\"f2 mt2 font-lobster\"},this.props.classInfo.className),/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"table-container mt-3\",style:{width:'100%'}},this.props.classInfo.students.length!=0?/*#__PURE__*/React.createElement(\"table\",{className:\"table1\",style:{width:'100%'}},/*#__PURE__*/React.createElement(\"thead\",{className:\"text-dark\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Student ID\"),/*#__PURE__*/React.createElement(\"th\",null,\"Student Name\"),/*#__PURE__*/React.createElement(\"th\",null,\"Delete\"))),/*#__PURE__*/React.createElement(\"tbody\",{className:\"tableBody\"},rows)):/*#__PURE__*/React.createElement(\"h1\",null,\"No Data Available\"))),!this.state.clickedAdd&&/*#__PURE__*/React.createElement(\"button\",{hidden:this.props.classInfo.students.length==0,className:\"my-button grow mt0\",onClick:this.onAddStd},\"Add Students\"),this.state.clickedAdd&&/*#__PURE__*/React.createElement(\"div\",{className:\"addStd-cont\"},/*#__PURE__*/React.createElement(AddStudents,{createNew:false,onAddStd:this.addStd})),this.state.isThereChanges&&/*#__PURE__*/React.createElement(\"div\",{className:\" btnEdCon\"},/*#__PURE__*/React.createElement(\"button\",{className:\"my-button grow red-btn\",\"hover-data\":\"Cancel Changes\",onClick:this.onCancel},/*#__PURE__*/React.createElement(\"i\",{class:\"  icon-big btn-icon  far fa-times-circle\"}),\" \"),/*#__PURE__*/React.createElement(\"button\",{className:\"my-button grn-btn grow\",\"hover-data\":\"Confirm Changes\",onClick:this.onConfirm},/*#__PURE__*/React.createElement(\"i\",{class:\"icon-big btn-icon far fa-check-circle\"}))),/*#__PURE__*/React.createElement(Row,{className:\"ma3 justify-content-start\"},/*#__PURE__*/React.createElement(Col,{className:\"pa0 justify-start flex\",xs:12,md:12},/*#__PURE__*/React.createElement(\"button\",{onClick:this.onDeleteClass,hidden:this.props.classInfo.students.length==0,className:\"delete-btn my-button grow red-btn\"},\"Delete Class ! \"))));}}]);return EditClass;}(Component);export default EditClass;","map":{"version":3,"sources":["/Users/mhd.sad22/graduation-project/graduation-project/src/components/EditClass.js"],"names":["React","Component","Col","Row","AddStudents","Swal","EditClass","renderTable","students","rows","map","std","id","name","deleteStd","setState","swalWithBootstrapButtons","mixin","customClass","confirmButton","cancelButton","buttonsStyling","fire","title","text","icon","showCancelButton","confirmButtonText","cancelButtonText","reverseButtons","then","result","isConfirmed","changedList","concat","state","lastStateOfStudents","length","filter","key","isThereChanges","dismiss","DismissReason","cancel","addStd","arr","idsOfCurrentStudents","obj","join","forEach","includes","push","clickedAdd","onAddStd","onDeleteClass","html","confirmButtonColor","cancelButtonColor","classData","className","props","classInfo","baseUrl","document","getElementById","defaultValue","url","requestOptions","method","headers","body","JSON","stringify","fetch","res","json","console","log","catch","e","onChangeRoute","onConfirm","showDenyButton","denyButtonText","isDenied","onCancel","back","width"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Component } from 'react';\nimport { Col, Row } from 'react-bootstrap';\nimport AddStudents from './AddStudents';\nimport Swal from 'sweetalert2'\nimport '../css/CreateClass.css';\nimport '../css/table.css';\nimport '../css/myClasses.css';\n\nclass EditClass extends Component {\n    constructor() {\n        super();\n        this.state = {\n            rows: [],\n            clickedAdd: false,\n            isThereChanges: false,\n            students: [],\n            lastStateOfStudents: [],\n        }\n    }\n\n    componentDidMount() {\n        let students = [].concat(this.props.classInfo.students);\n        this.renderTable(students);\n        this.setState({ students });\n    }\n\n    renderTable = (students) => {\n        let rows = students.map((std) => {\n            return (\n                <tr id={`r${std.id}`} key={std.id}>\n                    <td>{std.id}</td>\n                    <td>{std.name}</td>\n                    <td onClick={() => this.deleteStd(std.id)}><i class=\"icon-delete fas fa-user-times\"></i></td>\n                </tr>\n            )\n        });\n        this.setState({ rows });\n    }\n\n    deleteStd = (id) => {\n        const swalWithBootstrapButtons = Swal.mixin({\n            customClass: {\n                confirmButton: 'btn btn-success',\n                cancelButton: 'btn btn-danger'\n            },\n            buttonsStyling: false\n        })\n\n        swalWithBootstrapButtons.fire({\n            title: 'Are you sure?',\n            text: \"You want to delete this student\",\n            icon: 'warning',\n            showCancelButton: true,\n            confirmButtonText: 'Yes, delete it!',\n            cancelButtonText: 'No, cancel!',\n            reverseButtons: true\n        }).then((result) => {\n            if (result.isConfirmed) {\n                let changedList = [].concat(this.state.lastStateOfStudents);\n                let lastStateOfStudents = changedList.length ? changedList : [].concat(this.state.students);\n                lastStateOfStudents = lastStateOfStudents.filter(std => {\n                    return std.id !== id;\n                })\n                let rows = this.state.rows;\n                rows = rows.filter(std => std.key !== id);\n                this.setState({\n                    rows,\n                    isThereChanges: true,\n                    lastStateOfStudents\n                });\n                swalWithBootstrapButtons.fire(\n                    'Deleted!',\n                    'Student has been deleted.',\n                    'success'\n                )\n            } else if (\n                result.dismiss === Swal.DismissReason.cancel\n            ) {\n                swalWithBootstrapButtons.fire(\n                    'Cancelled',\n                    'No changes done',\n                    'error'\n                )\n            }\n        })\n\n    }\n\n    addStd = (arr) => {\n        let changedList = [].concat(this.state.lastStateOfStudents);\n        let lastStateOfStudents = changedList.length ? changedList : [].concat(this.state.students);\n        let idsOfCurrentStudents = lastStateOfStudents.map(obj => obj.id).join(' ');\n        let isThereChanges = this.state.isThereChanges;\n        arr.forEach(std => {\n            if (!idsOfCurrentStudents.includes(std.id)) {\n                lastStateOfStudents.push(std);\n                this.renderTable(lastStateOfStudents);\n                isThereChanges = true;\n            }\n        });\n        this.setState({\n            clickedAdd: false,\n            isThereChanges,\n            lastStateOfStudents\n        });\n    }\n\n    onAddStd = () => {\n        this.setState({ clickedAdd: true });\n    }\n\n    onDeleteClass = () => {\n        Swal.fire({\n            title: 'Are you sure?',\n            html: \"<h5 class='text-danger'>You want to delete this class</h5>\",\n            icon: 'warning',\n            showCancelButton: true,\n            confirmButtonColor: '#3085d6',\n            cancelButtonColor: '#d33',\n            confirmButtonText: 'Yes, delete it!'\n        }).then((result) => {\n            if (result.isConfirmed) {\n                let classData = {\n                    className: this.props.classInfo.className\n                }\n                let baseUrl = document.getElementById('baseUrl').defaultValue;\n                let url = `${baseUrl}/deleteClass`;\n                let requestOptions = {\n                    method: 'DELETE',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify(classData),\n                }\n                fetch(url, requestOptions)\n                    .then(res => res.json())\n                    .then(console.log)\n                    .catch(e => { console.log(\"error on Delete class request..\", e) });\n                this.props.onChangeRoute('/show', 500);\n                Swal.fire(\n                    'Deleted!',\n                    'Class has been deleted.',\n                    'success'\n                )\n            }\n        })\n    }\n\n    onConfirm = () => {\n        Swal.fire({\n            title: 'Do you want to save the changes?',\n            showDenyButton: true,\n            showCancelButton: true,\n            confirmButtonText: `Save`,\n            denyButtonText: `Don't save`,\n            icon: 'info'\n        }).then((result) => {\n            if (result.isConfirmed) {\n                let classData = {\n                    className: this.props.classInfo.className,\n                    students: this.state.lastStateOfStudents\n                }\n                let baseUrl = document.getElementById('baseUrl').defaultValue;\n                let url = `${baseUrl}/editClass`;\n                let requestOptions = {\n                    method: 'PUT',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify(classData),\n                }\n                fetch(url, requestOptions)\n                    .then(res => res.json())\n                    .then(console.log)\n                    .catch(e => { console.log(\"error on edit class request..\", e) });\n\n                this.setState({\n                    isThereChanges: false,\n                    lastStateOfStudents: [],\n                });\n                this.props.onChangeRoute('/show', 500);\n                Swal.fire('Saved!', '', 'success')\n            } else if (result.isDenied) {\n                this.onCancel();\n                Swal.fire('Changes are not saved', '', 'info')\n            }\n        })\n    }\n\n    onCancel = () => {\n        this.renderTable(this.state.students);\n        this.setState({\n            isThereChanges: false,\n            lastStateOfStudents: []\n        });\n    }\n\n    back = () => {\n        this.setState({\n        });\n        this.props.onChangeRoute('/show/classData', 0);\n    }\n\n    render() {\n        let { rows } = this.state;\n        return (\n            <div id=\"edit-class1\" className=\"edit-class\">\n                <div className=\"js\">\n                    <button hover-data=\"Back\"\n                        onClick={this.back} className=\"red-btn my-button\">\n                        <i className=\"btn-icon far fa-arrow-alt-circle-left\"></i>\n                    </button>\n                </div>\n                <h2 className=\"f2 mt2 font-lobster\">{this.props.classInfo.className}</h2>\n                <>\n                <div className=\"table-container mt-3\" style={{width:'100%'}}>\n                    {this.props.classInfo.students.length != 0 ?\n                        <table className=\"table1\" style={{ width: '100%' }}>\n                            <thead className=\"text-dark\">\n                                <tr>\n                                    <th>Student ID</th>\n                                    <th>Student Name</th>\n                                    <th>Delete</th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"tableBody\" >\n                                {rows}\n                            </tbody>\n                        </table>\n                    :\n                        <h1>No Data Available</h1>\n                    }\n                    </div>\n\n                </>\n\n                { !this.state.clickedAdd && (<button hidden={this.props.classInfo.students.length == 0} className=\"my-button grow mt0\" onClick={this.onAddStd}>Add Students</button>)}\n                {   this.state.clickedAdd && (\n                <div className=\"addStd-cont\">\n                    <AddStudents createNew={false} onAddStd={this.addStd} />\n                </div> \n                \n                )}\n\n                { this.state.isThereChanges && (\n                    <div className=\" btnEdCon\">\n                        <button className=\"my-button grow red-btn\" hover-data=\"Cancel Changes\" onClick={this.onCancel}><i class=\"  icon-big btn-icon  far fa-times-circle\"></i> </button>\n                        <button className=\"my-button grn-btn grow\" hover-data=\"Confirm Changes\" onClick={this.onConfirm}><i class=\"icon-big btn-icon far fa-check-circle\"></i></button>\n                    </div>\n                )}\n                <Row className=\"ma3 justify-content-start\"  >\n                    <Col className=\"pa0 justify-start flex\" xs={12} md={12}><button onClick={this.onDeleteClass} hidden={this.props.classInfo.students.length == 0} className=\"delete-btn my-button grow red-btn\">Delete Class ! </button></Col>\n                </Row>\n            </div>\n        )\n    }\n\n}\nexport default EditClass;"]},"metadata":{},"sourceType":"module"}