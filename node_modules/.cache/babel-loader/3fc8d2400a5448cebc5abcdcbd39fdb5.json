{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/mhd.sad22/graduation-project/graduation-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{Col,Row}from'react-bootstrap';import React,{Component}from'react';import noImage from'../noImage.png';import StudentsTable from'./StudentsTable';import Details from'./Details';import History from'./History';import{storage}from'../firebase/index';import EditClass from'./EditClass';import{Link,Redirect,Route}from'react-router-dom';import'../css/myClasses.css';import'../css/home.css';var initialState={file:null,width:0,height:0,ids:[],students:[],absenceStudents:[],attendStudents:[],showImage:true,showUploadBtn:false,load:false,hidePage:false,classes:[],selected_class:'',imgs:[],faces:[],disableButton:false,direction:'check',// OR history , details , edit\nhistoryData:{},route:null,doneDisable:true,showStudents:[],flag:0};var MyClasses=/*#__PURE__*/function(_Component){_inherits(MyClasses,_Component);var _super=_createSuper(MyClasses);function MyClasses(){var _this;_classCallCheck(this,MyClasses);_this=_super.call(this);_this.checkLoggedIn=function(){var data=sessionStorage.getItem('teacher');if(!data){_this.setState({route:'/login'});return false;}else{return true;}};_this.checkAttendence=function(e){_this.setState({load:true,doneDisable:true});//Create a reader to read an uploaded file .\nvar reader=new FileReader();reader.readAsDataURL(e.target.files[0]);reader.onload=function(event){//Get the uploaded image and store it in let image .\nvar image=new Image();image.src=event.target.result;//Create to letiable to store image width and height .\nvar imgHeight,imgWidth;image.onload=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:imgHeight=this.height;imgWidth=this.width;//The function will store width and height values in State . \nsetData();case 3:case\"end\":return _context.stop();}}},_callee,this);}));var setData=function setData(){_this.setState({width:imgWidth,height:imgHeight});};};var img=e.target;if(img){_this.setState({file2:e.target.files[0],file:URL.createObjectURL(e.target.files[0])});_this.faceRecognition(img.files[0]);}e.target.value=null;};_this.setShowBtn=function(){_this.setState({showUploadBtn:true});};_this.sendHistoryData=function(){var requestOptions={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({'ids':_this.state.ids,'imgs':_this.state.imgs})};var baseUrl=document.getElementById('baseUrl').defaultValue;fetch(\"\".concat(baseUrl,\"/history/\").concat(_this.state.selected_class),requestOptions).then(function(res){return res.json();}).then(console.log).catch(function(e){console.log(\"An Error occured while sending history Data ..\",e);});var date=new Date();var fullDate=date.getDate()+\"/\"+(date.getMonth()+1)+\"/\"+date.getFullYear();var historyData={students:_this.state.ids,allStudents:_this.state.students,imgs:_this.state.imgs,className:_this.state.selected_class,date:fullDate};_this.clear();_this.setState({ids:[],imgs:[],selected_class:[],historyData:historyData,disableButton:true,route:'/show/details'});};_this.faceRecognition=function(img){var formdata=new FormData();formdata.append(\"photo\",img,\"file\");var requestOptions={method:'POST',body:formdata,redirect:'follow'};var baseUrl=document.getElementById('baseUrl').defaultValue;fetch(\"\".concat(baseUrl,\"/checkImage\"),requestOptions).then(function(response){return response.json();}).then(function(result){console.log(result);//Define canvas to draw rectangle .\nvar canvas=document.getElementById('canvas');var ctx=canvas.getContext('2d');//Canvas properties .\nctx.strokeStyle='#fcff04';ctx.fillStyle='#fcff04';ctx.lineWidth='3';//Change the background of context to the uploaded image .\nvar image=document.getElementById('person');ctx.drawImage(image,0,0);var studetnsIDs=_this.state.students.map(function(std){return std.id;});var ids=_this.state.ids;for(var i in result){var name=result[i].name.substring(0,result[i].name.indexOf('|'));var id=result[i].name.substring(result[i].name.indexOf('|')+2);if(!studetnsIDs.includes(id)){continue;}if(result[i].probability*100<85){continue;}if(!ids.includes(id)){ids.push(id);}//Get the values of Rectangle .\nvar _result$i$rectangle=result[i].rectangle,left=_result$i$rectangle.left,right=_result$i$rectangle.right,bottom=_result$i$rectangle.bottom,top=_result$i$rectangle.top;//Determine the width and hight for rectangle .\nvar Dim=right-left;//Determine font size and the space between rectangle and text .\nvar _space=parseInt(Dim/3)+2,_text=\"\".concat(_space,\"px Carter One\");ctx.font=_text;//Draw the rectangle .\nctx.strokeRect(left,top,Dim,Dim);//Type the name of person .\nctx.fillText(name,left,bottom+_space);}var attendStudents=[];var absenceStudents=[];var _iterator=_createForOfIteratorHelper(_this.state.students),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _i=_step.value;var flag=false;var _iterator2=_createForOfIteratorHelper(_this.state.ids),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var j=_step2.value;if(_i.id===j){flag=true;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}if(flag){attendStudents.push({id:_i.id,name:_i.name});}else{absenceStudents.push({id:_i.id,name:_i.name});}}}catch(err){_iterator.e(err);}finally{_iterator.f();}_this.setState({ids:ids,attendStudents:attendStudents,absenceStudents:absenceStudents// imgs : [imagesLink]\n});var space=_this.state.width/20;ctx.fillStyle='black';var text=\"\".concat(space,\"px serif\");ctx.font=text;ctx.fillText(new Date().toLocaleString(),_this.state.width/2-5*space,50);_this.setState({showImage:false});// Store image in firebase ........\nvar dataURL=canvas.toDataURL(\"image/png\");console.log(ids);_this.setState({file:dataURL});var formdata=_this.getImageURL(dataURL);_this.convertImageToURL(formdata.get('image'));console.log(\"Imgs : \",_this.state.imgs);_this.colorTable(result);_this.setState({load:false});}).catch(function(error){return console.log('error',error);});};_this.colorTable=function(){var ids=_this.state.ids;var _iterator3=_createForOfIteratorHelper(ids),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var i=_step3.value;var row=document.getElementById(i+\"\");if(row){row.style.backgroundColor='#178326a2';}}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}};_this.clear=function(){_this.setState({showImage:true,showUploadBtn:false,ids:[],imgs:[]});document.getElementById(\"file2\").value='';var students=_this.state.students;var _iterator4=_createForOfIteratorHelper(students),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var student=_step4.value;var stdRow=document.getElementById(student.id);if(stdRow){stdRow.className='';}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}};_this.CheckClass=function(e){var cName=e.target.getAttribute('data-class');console.log(cName);var arr=[];var classes=_this.state.classes;classes.forEach(function(element){if(element.className===cName){element.students.forEach(function(std){arr.push({id:std.id_number,name:std.firstName+\" \"+std.lastName});});}});console.log(arr,_this.state.classes);_this.setState({ids:[],imgs:[],students:arr,hidePage:true,showStudents:arr,selected_class:cName,route:'/show/classData'});};_this.editClass=function(){_this.setState({direction:'edit',route:'/show/editClass'});};_this.back=function(){_this.setState({hidePage:false,route:'/show'});_this.clear();};_this.showHistoryPage=function(){_this.setState({route:'/show/classHistory'});};_this.showAllStudents=function(){var showStudents=_this.state.students;_this.setState({showStudents:showStudents});_this.colorTable();};_this.showAttendStudents=function(){var showStudents=_this.state.attendStudents;_this.setState({showStudents:showStudents});};_this.showAbcentStudents=function(){var showStudents=_this.state.absenceStudents;_this.setState({showStudents:showStudents});};_this.onChangeRoute=function(route,timer){setTimeout(function(){console.log(route,\"clicked\");if(_this.checkLoggedIn()){var baseUrl=document.getElementById('baseUrl').defaultValue;fetch(\"\".concat(baseUrl,\"/teacherClasses?id=\")+JSON.parse(sessionStorage.getItem('teacher')).id_number).then(function(res){return res.json();}).then(function(data){_this.setState({classes:data,route:route});}).catch(function(e){return console.log(e);});}},timer);};_this.state=initialState;return _this;}// Get all the classes for the logged in teacher .\n_createClass(MyClasses,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(this.checkLoggedIn()){var baseUrl=document.getElementById('baseUrl').defaultValue;fetch(\"\".concat(baseUrl,\"/teacherClasses?id=\")+JSON.parse(sessionStorage.getItem('teacher')).id_number).then(function(res){return res.json();}).then(function(data){_this2.setState({classes:data});}).catch(function(e){return console.log(e);});}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.setState({flag:0});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this3=this;if(prevState.flag!==1){if(this.checkLoggedIn()){var baseUrl=document.getElementById('baseUrl').defaultValue;fetch(\"\".concat(baseUrl,\"/teacherClasses?id=\")+JSON.parse(sessionStorage.getItem('teacher')).id_number).then(function(res){return res.json();}).then(function(data){_this3.setState({classes:data,flag:1});}).catch(function(e){return console.log(e);});}}}//To Check if LoggedIn .\n},{key:\"getImageURL\",value:function getImageURL(dataURL){var blobBin=atob(dataURL.split(',')[1]);var array=[];for(var i=0;i<blobBin.length;i++){array.push(blobBin.charCodeAt(i));}var file=new Blob([new Uint8Array(array)],{type:'image/png'});var formdata=new FormData();formdata.append(\"image\",file);return formdata;}},{key:\"convertImageToURL\",value:function convertImageToURL(image){var _this4=this;if(image){var imageName=\"studentsImage\"+new Date().getTime();var upload=storage.ref(\"images/\".concat(imageName)).put(image);upload.on('state_changed',function(snapshot){},function(err){console.log(\"error while getting data from firebase.\\n\",err);return'';},function(){storage.ref('images').child(imageName).getDownloadURL().then(function(urll){console.log(urll);var imgs=[].concat(_this4.state.imgs);imgs.push(urll);_this4.setState({imgs:imgs,doneDisable:false});return urll;});});}}// To change the row color according to the attendence .\n},{key:\"render\",value:function render(){var _this5=this;var path=this.props.match.path;var classInfo={'students':this.state.students,'className':this.state.selected_class};var rows=this.state.classes.map(function(cs){return/*#__PURE__*/React.createElement(\"div\",{onClick:_this5.CheckClass,key:cs._id,\"data-class\":cs.className,\"data-student\":cs.students,id:\"class:\".concat(cs._id),className:\"cont-card\"},/*#__PURE__*/React.createElement(\"div\",{\"data-class\":cs.className,className:\"inner-cont-card  large button card-front\"},/*#__PURE__*/React.createElement(\"p\",{\"data-class\":cs.className},cs.className),/*#__PURE__*/React.createElement(\"i\",{\"data-class\":cs.className,className:\"far fa-paper-plane icons\"})),/*#__PURE__*/React.createElement(\"div\",{\"data-class\":cs.className,className:\"panel card-back\"},/*#__PURE__*/React.createElement(\"div\",{\"data-class\":cs.className,className:\"inner-cont-card hub-info\"},/*#__PURE__*/React.createElement(\"i\",{\"data-class\":cs.className,className:\"far mb-3 fa-edit icons\"}),/*#__PURE__*/React.createElement(\"p\",{\"data-class\":cs.className},\"Contains \",/*#__PURE__*/React.createElement(\"br\",null),\" \",/*#__PURE__*/React.createElement(\"span\",{\"data-class\":cs.className,className:\"number-span\"},cs.students.length),\" \",/*#__PURE__*/React.createElement(\"br\",null),\" Students\"))));});return/*#__PURE__*/React.createElement(React.Fragment,null,this.state.route?/*#__PURE__*/React.createElement(Redirect,{to:this.state.route}):null,this.state.classes.length===0&&/*#__PURE__*/React.createElement(\"section\",{className:\"hero-unit\"},/*#__PURE__*/React.createElement(\"h1\",{style:{marginTop:'150px'}},\" \",\"You don't have any class yet.. \"),/*#__PURE__*/React.createElement(\"button\",{style:{margin:'50px 0'},className:\"my-button\"},/*#__PURE__*/React.createElement(Link,{style:{color:'#eee',textDecoration:'none'},to:\"/create\"},\"Create a new class..\"))),this.state.classes.length!==0&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Route,{path:\"\".concat(path,\"/editClass\"),component:function component(){return/*#__PURE__*/React.createElement(EditClass,{classInfo:classInfo,onChangeRoute:_this5.onChangeRoute});}}),/*#__PURE__*/React.createElement(Route,{path:\"\".concat(path,\"/classHistory\"),component:function component(){return/*#__PURE__*/React.createElement(History,{selected_class:_this5.state.selected_class,onChangeRoute:_this5.onChangeRoute});}}),/*#__PURE__*/React.createElement(Route,{path:\"\".concat(path,\"/details\"),component:function component(){return/*#__PURE__*/React.createElement(Details,{historyData:_this5.state.historyData,onChangeRoute:_this5.onChangeRoute,backToHistory:false});}}),/*#__PURE__*/React.createElement(Route,{path:\"\".concat(path),exact:true},/*#__PURE__*/React.createElement(\"div\",{className:\" text-center\"},/*#__PURE__*/React.createElement(\"section\",{className:\"hero-unit\"},/*#__PURE__*/React.createElement(\"hgroup\",null,/*#__PURE__*/React.createElement(\"h2\",{className:\"select-class\"},\"Select A Class \")),/*#__PURE__*/React.createElement(\"div\",{className:\"flip-cards\"},rows)))),/*#__PURE__*/React.createElement(Route,{path:\"\".concat(path,\"/classData\")},/*#__PURE__*/React.createElement(\"div\",{className:\"bg--white\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"container myCont\"},/*#__PURE__*/React.createElement(\"div\",{class:\"loader\",hidden:!this.state.load},/*#__PURE__*/React.createElement(\"ul\",{class:\"hexagon-container\"},/*#__PURE__*/React.createElement(\"li\",{class:\"hexagon hex_1\"}),/*#__PURE__*/React.createElement(\"li\",{class:\"hexagon hex_2\"}),/*#__PURE__*/React.createElement(\"li\",{class:\"hexagon hex_3\"}),/*#__PURE__*/React.createElement(\"li\",{class:\"hexagon hex_4\"}),/*#__PURE__*/React.createElement(\"li\",{class:\"hexagon hex_5\"}),/*#__PURE__*/React.createElement(\"li\",{class:\"hexagon hex_6\"}),/*#__PURE__*/React.createElement(\"li\",{class:\"hexagon hex_7\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\" divBtns btns\"},/*#__PURE__*/React.createElement(\"button\",{\"hover-data\":\"Back\",onClick:this.back,className:\"ma1 red-btn my-button\",hidden:this.state.load},/*#__PURE__*/React.createElement(\"i\",{className:\"btn-icon far fa-arrow-alt-circle-left\"})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"button\",{\"hover-data\":\"Edit Class\",hidden:this.state.load,onClick:this.editClass,className:\" ma1 my-button\"},/*#__PURE__*/React.createElement(\"i\",{className:\"btn-icon fas fa-users-cog\"})),/*#__PURE__*/React.createElement(\"button\",{\"hover-data\":\"Class History\",hidden:this.state.load,onClick:this.showHistoryPage,className:\" ma1 my-button\"},/*#__PURE__*/React.createElement(\"i\",{className:\"btn-icon fas fa-history\"})))),/*#__PURE__*/React.createElement(\"h3\",{hidden:this.state.load,className:\"f2 mt4 font-lobster\"},this.state.selected_class),/*#__PURE__*/React.createElement(\"div\",{className:\"my-line2\",hidden:this.state.load}),/*#__PURE__*/React.createElement(Row,{hidden:this.state.load},/*#__PURE__*/React.createElement(Col,{xs:12},/*#__PURE__*/React.createElement(\"button\",{hidden:this.state.showUploadBtn,onClick:this.setShowBtn,className:\"my-button mt-4\"},\"Check Attendence\"),/*#__PURE__*/React.createElement(\"div\",{hidden:!this.state.showUploadBtn},/*#__PURE__*/React.createElement(\"p\",{hidden:!this.state.showImage,className:\"mt-5 f3 b i upload-text\"},\"Upload one or more image to take the attendance, Then click on \",/*#__PURE__*/React.createElement(\"span\",{className:\"red f3\"},\"'Done'\"),\" Button.\"),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"file2\",className:\"mt-3 my-button f4 pointer\"},this.state.ids.length===0?'Upload An Image ':'Upload Another Image ',\" \",/*#__PURE__*/React.createElement(\"i\",{class:\" fas fa-cloud-upload-alt\"}),\"   \"),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",hidden:true,onChange:this.checkAttendence,accept:\"image/*\",id:\"file2\",className:\"form-file mt-4 \",required:true}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"img\",{hidden:true,id:\"person\",src:this.state.file,alt:\"Person\"}),/*#__PURE__*/React.createElement(\"canvas\",{id:\"canvas\",width:this.state.width,height:this.state.height,hidden:true}),/*#__PURE__*/React.createElement(\"img\",{className:\"img-thumbnail mt-4\",src:this.state.file||noImage,alt:\"Person\",width:\"300\",height:\"300\",hidden:this.state.showImage}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"table-buttons2\"},/*#__PURE__*/React.createElement(\"button\",{hidden:this.state.showImage,onClick:this.clear,className:\"my-button grow red-btn\"},/*#__PURE__*/React.createElement(\"i\",{class:\"fas fa-trash-alt\"})),/*#__PURE__*/React.createElement(\"button\",{hidden:this.state.showImage,className:\"my-button  grow\"},/*#__PURE__*/React.createElement(\"a\",{href:\"\".concat(this.state.file),download:true}),\" \",/*#__PURE__*/React.createElement(\"i\",{class:\"fas fa-download\"}),\" \"),/*#__PURE__*/React.createElement(\"button\",{hidden:this.state.showImage,onClick:this.sendHistoryData,disabled:this.state.doneDisable,className:\"my-button grn-btn grow \"},\"Done\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"my-line\",hidden:this.state.load}),/*#__PURE__*/React.createElement(Row,{hidden:this.state.load,className:\"mt5\"},/*#__PURE__*/React.createElement(Col,{xs:12},/*#__PURE__*/React.createElement(\"h3\",{className:\"mt-2 table-header font-acme\"},\"Students enrolled this course\"),/*#__PURE__*/React.createElement(StudentsTable,{students:this.state.showStudents}),/*#__PURE__*/React.createElement(\"div\",{className:\"table-buttons\"},/*#__PURE__*/React.createElement(\"button\",{onClick:this.showAllStudents,className:\"my-button grow\"},\"All Students\"),/*#__PURE__*/React.createElement(\"button\",{onClick:this.showAttendStudents,className:\"my-button grn-btn grow\"},\"Attendance Students\"),/*#__PURE__*/React.createElement(\"button\",{onClick:this.showAbcentStudents,className:\"my-button grow red-btn\"},\"Absence Students\"))))))));}}]);return MyClasses;}(Component);export default MyClasses;","map":{"version":3,"sources":["/Users/mhd.sad22/graduation-project/graduation-project/src/components/MyClasses.js"],"names":["Col","Row","React","Component","noImage","StudentsTable","Details","History","storage","EditClass","Link","Redirect","Route","initialState","file","width","height","ids","students","absenceStudents","attendStudents","showImage","showUploadBtn","load","hidePage","classes","selected_class","imgs","faces","disableButton","direction","historyData","route","doneDisable","showStudents","flag","MyClasses","checkLoggedIn","data","sessionStorage","getItem","setState","checkAttendence","e","reader","FileReader","readAsDataURL","target","files","onload","event","image","Image","src","result","imgHeight","imgWidth","setData","img","file2","URL","createObjectURL","faceRecognition","value","setShowBtn","sendHistoryData","requestOptions","method","headers","body","JSON","stringify","state","baseUrl","document","getElementById","defaultValue","fetch","then","res","json","console","log","catch","date","Date","fullDate","getDate","getMonth","getFullYear","allStudents","className","clear","formdata","FormData","append","redirect","response","canvas","ctx","getContext","strokeStyle","fillStyle","lineWidth","drawImage","studetnsIDs","map","std","id","i","name","substring","indexOf","includes","probability","push","rectangle","left","right","bottom","top","Dim","space","parseInt","text","font","strokeRect","fillText","j","toLocaleString","dataURL","toDataURL","getImageURL","convertImageToURL","get","colorTable","error","row","style","backgroundColor","student","stdRow","CheckClass","cName","getAttribute","arr","forEach","element","id_number","firstName","lastName","editClass","back","showHistoryPage","showAllStudents","showAttendStudents","showAbcentStudents","onChangeRoute","timer","setTimeout","parse","prevProps","prevState","blobBin","atob","split","array","length","charCodeAt","Blob","Uint8Array","type","imageName","getTime","upload","ref","put","on","snapshot","err","child","getDownloadURL","urll","concat","path","props","match","classInfo","rows","cs","_id","marginTop","margin","color","textDecoration"],"mappings":"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","sourcesContent":["import { Col, Row } from 'react-bootstrap';\nimport React, { Component } from 'react';\nimport noImage from '../noImage.png';\nimport StudentsTable from './StudentsTable';\nimport Details from './Details';\nimport History from './History';\nimport { storage } from '../firebase/index';\nimport EditClass from './EditClass';\nimport { Link, Redirect, Route } from 'react-router-dom';\nimport '../css/myClasses.css';\nimport '../css/home.css';\n\nconst initialState = {\n    file: null,\n    width: 0,\n    height: 0,\n    ids: [],\n    students: [],\n    absenceStudents: [],\n    attendStudents: [],\n    showImage: true,\n    showUploadBtn: false,\n    load: false,\n    hidePage: false,\n    classes: [],\n    selected_class: '',\n    imgs: [],\n    faces: [],\n    disableButton: false,\n    direction: 'check', // OR history , details , edit\n    historyData: {},\n    route: null,\n    doneDisable: true,\n    showStudents: [],\n    flag: 0\n}\nclass MyClasses extends Component {\n    constructor() {\n        super();\n        this.state = initialState;\n    }\n\n    // Get all the classes for the logged in teacher .\n    componentDidMount() {\n        if (this.checkLoggedIn()) {\n            let baseUrl = document.getElementById('baseUrl').defaultValue;\n            fetch(`${baseUrl}/teacherClasses?id=` + JSON.parse(sessionStorage.getItem('teacher')).id_number)\n                .then(res => res.json()).then(data => {\n                    this.setState({\n                        classes: data,\n\n                    })\n                })\n                .catch(e => console.log(e));\n        }\n    }\n    componentWillUnmount() {\n        this.setState({ flag: 0 })\n    }\n    componentDidUpdate(prevProps, prevState) {\n        if (prevState.flag !== 1) {\n            if (this.checkLoggedIn()) {\n                let baseUrl = document.getElementById('baseUrl').defaultValue;\n                fetch(`${baseUrl}/teacherClasses?id=` + JSON.parse(sessionStorage.getItem('teacher')).id_number)\n                    .then(res => res.json()).then(data => {\n                        this.setState({\n                            classes: data,\n                            flag: 1\n\n                        })\n                    })\n                    .catch(e => console.log(e));\n            }\n        }\n    }\n\n    //To Check if LoggedIn .\n    checkLoggedIn = () => {\n        const data = sessionStorage.getItem('teacher');\n        if (!data) {\n            this.setState({\n                route: '/login'\n            })\n            return false;\n        }\n        else {\n            return true;\n        }\n    }\n\n    // Will check the faces from the uploaded image .\n    checkAttendence = (e) => {\n        this.setState({\n            load: true,\n            doneDisable: true\n        });\n\n        //Create a reader to read an uploaded file .\n        let reader = new FileReader();\n        reader.readAsDataURL(e.target.files[0]);\n\n        reader.onload = (event) => {\n            //Get the uploaded image and store it in let image .\n            let image = new Image();\n            image.src = event.target.result;\n\n            //Create to letiable to store image width and height .\n            let imgHeight, imgWidth;\n            image.onload = async function () {\n                imgHeight = this.height;\n                imgWidth = this.width;\n\n                //The function will store width and height values in State . \n                setData();\n            }\n            let setData = () => {\n                this.setState({\n                    width: imgWidth,\n                    height: imgHeight\n                });\n            }\n        };\n\n        const img = e.target;\n        if (img) {\n            this.setState({\n                file2: e.target.files[0],\n                file: URL.createObjectURL(e.target.files[0])\n            })\n            this.faceRecognition(img.files[0]);\n        }\n        e.target.value = null;\n    }\n\n    // To show checkAttendence page .\n    setShowBtn = () => {\n        this.setState({\n            showUploadBtn: true\n        });\n    }\n\n    sendHistoryData = () => {\n        let requestOptions = {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                'ids': this.state.ids,\n                'imgs': this.state.imgs\n            }),\n        };\n        let baseUrl = document.getElementById('baseUrl').defaultValue;\n        fetch(`${baseUrl}/history/${this.state.selected_class}`, requestOptions)\n            .then(res => res.json())\n            .then(console.log)\n            .catch(e => { console.log(\"An Error occured while sending history Data ..\", e) });\n        let date = new Date();\n        let fullDate = date.getDate() + \"/\" + (date.getMonth() + 1) + \"/\" + date.getFullYear();\n        let historyData = {\n            students: this.state.ids,\n            allStudents: this.state.students,\n            imgs: this.state.imgs,\n            className: this.state.selected_class,\n            date: fullDate\n        };\n        this.clear();\n        this.setState({\n            ids: [],\n            imgs: [],\n            selected_class: [],\n            historyData: historyData,\n            disableButton: true,\n            route: '/show/details',\n        })\n    }\n\n    // To detect faces from an image .\n    faceRecognition = (img) => {\n\n        let formdata = new FormData();\n        formdata.append(\"photo\", img, \"file\");\n\n        let requestOptions = {\n            method: 'POST',\n            body: formdata,\n            redirect: 'follow'\n        };\n\n\n        let baseUrl = document.getElementById('baseUrl').defaultValue;\n        fetch(`${baseUrl}/checkImage`, requestOptions)\n            .then(response => response.json())\n            .then(result => {\n\n                console.log(result);\n                //Define canvas to draw rectangle .\n                let canvas = document.getElementById('canvas');\n                let ctx = canvas.getContext('2d');\n\n                //Canvas properties .\n                ctx.strokeStyle = '#fcff04';\n                ctx.fillStyle = '#fcff04';\n                ctx.lineWidth = '3';\n\n                //Change the background of context to the uploaded image .\n                let image = document.getElementById('person');\n                ctx.drawImage(image, 0, 0);\n                let studetnsIDs = this.state.students.map(std => {\n                    return std.id\n                });\n                let { ids } = this.state;\n                for (let i in result) {\n                    let name = result[i].name.substring(0, result[i].name.indexOf('|'));\n                    let id = result[i].name.substring(result[i].name.indexOf('|') + 2);\n                    if (!studetnsIDs.includes(id)) {\n                        continue;\n                    }\n                    if (result[i].probability * 100 < 85) {\n                        continue;\n                    }\n\n                    if (!ids.includes(id)) {\n                        ids.push(id);\n                    }\n\n                    //Get the values of Rectangle .\n                    let { left, right, bottom, top } = result[i].rectangle;\n\n                    //Determine the width and hight for rectangle .\n                    let Dim = (right - left);\n\n                    //Determine font size and the space between rectangle and text .\n                    let space = parseInt(Dim / 3) + 2,\n                        text = `${space}px Carter One`;\n                    ctx.font = text;\n\n                    //Draw the rectangle .\n                    ctx.strokeRect(left, top, Dim, Dim);\n\n                    //Type the name of person .\n                    ctx.fillText(name, left, bottom + space);\n                }\n\n                let attendStudents = [];\n                let absenceStudents = [];\n                for (let i of this.state.students) {\n                    let flag = false;\n                    for (let j of this.state.ids) {\n                        if (i.id === j) {\n                            flag = true;\n                        }\n                    }\n                    if (flag) {\n                        attendStudents.push({\n                            id: i.id,\n                            name: i.name\n                        });\n                    }\n                    else {\n                        absenceStudents.push({\n                            id: i.id,\n                            name: i.name\n                        });\n                    }\n                }\n\n                this.setState({\n                    ids: ids,\n                    attendStudents,\n                    absenceStudents\n                    // imgs : [imagesLink]\n                });\n                let space = this.state.width / 20;\n                ctx.fillStyle = 'black';\n                let text = `${space}px serif`;\n                ctx.font = text;\n                ctx.fillText(new Date().toLocaleString(), (this.state.width / 2) - 5 * space, 50);\n                this.setState({ showImage: false });\n                // Store image in firebase ........\n                let dataURL = canvas.toDataURL(\"image/png\");\n                console.log(ids);\n                this.setState({\n                    file: dataURL\n                });\n\n                let formdata = this.getImageURL(dataURL);\n                this.convertImageToURL(formdata.get('image'));\n\n                console.log(\"Imgs : \", this.state.imgs);\n                this.colorTable(result);\n                this.setState({\n                    load: false\n                });\n\n            })\n            .catch(error => console.log('error', error));\n    };\n\n    getImageURL(dataURL) {\n        let blobBin = atob(dataURL.split(',')[1]);\n        let array = [];\n        for (let i = 0; i < blobBin.length; i++) {\n            array.push(blobBin.charCodeAt(i));\n        }\n        let file = new Blob([new Uint8Array(array)], { type: 'image/png' });\n        let formdata = new FormData();\n        formdata.append(\"image\", file);\n        return formdata;\n    }\n\n    convertImageToURL(image) {\n        if (image) {\n            let imageName = \"studentsImage\" + new Date().getTime();\n            const upload = storage.ref(`images/${imageName}`).put(image);\n            upload.on('state_changed',\n                (snapshot) => { },\n                (err) => {\n                    console.log(\"error while getting data from firebase.\\n\", err);\n                    return '';\n                },\n                () => {\n                    storage.ref('images').child(imageName).getDownloadURL().then(urll => {\n                        console.log(urll);\n\n                        let imgs = [].concat(this.state.imgs);\n                        imgs.push(urll);\n                        this.setState({\n                            imgs: imgs,\n                            doneDisable: false\n                        })\n                        return urll;\n                    })\n\n                })\n        }\n    }\n\n    // To change the row color according to the attendence .\n    colorTable = () => {\n        let { ids } = this.state;\n        for (let i of ids) {\n            let row = document.getElementById(i + \"\");\n            if (row) {\n                row.style.backgroundColor = '#178326a2';\n            }\n        }\n    }\n\n    // Clear data from upload image and recolor the table .\n    clear = () => {\n        this.setState({\n            showImage: true,\n            showUploadBtn: false,\n            ids: [],\n            imgs: []\n        });\n        document.getElementById(\"file2\").value = '';\n        let { students } = this.state;\n        for (let student of students) {\n            let stdRow = document.getElementById(student.id);\n            if (stdRow) {\n                stdRow.className = '';\n            }\n        }\n    }\n\n    // Get the student of each class .\n    CheckClass = (e) => {\n        let cName = e.target.getAttribute('data-class');\n        console.log(cName);\n        let arr = []\n        let { classes } = this.state;\n        classes.forEach(element => {\n            if (element.className === cName) {\n\n                element.students.forEach((std) => {\n                    arr.push({ id: std.id_number, name: std.firstName + \" \" + std.lastName })\n                })\n            }\n        });\n\n        console.log(arr, this.state.classes);\n\n\n        this.setState({\n            ids: [],\n            imgs: [],\n            students: arr,\n            hidePage: true,\n            showStudents: arr,\n            selected_class: cName,\n            route: '/show/classData'\n        })\n    }\n\n    editClass = () => {\n        this.setState({\n            direction: 'edit',\n            route: '/show/editClass'\n        });\n    }\n\n\n    // Back to the classes page .\n    back = () => {\n        this.setState({\n            hidePage: false,\n            route: '/show'\n        });\n        this.clear();\n    }\n\n    showHistoryPage = () => {\n        this.setState({\n            route: '/show/classHistory'\n        });\n    }\n\n    showAllStudents = () => {\n        let showStudents = this.state.students;\n        this.setState({\n            showStudents\n        });\n        this.colorTable();\n    }\n\n    showAttendStudents = () => {\n        let showStudents = this.state.attendStudents;\n        this.setState({\n            showStudents\n        });\n    }\n\n    showAbcentStudents = () => {\n        let showStudents = this.state.absenceStudents;\n        this.setState({\n            showStudents\n        });\n    }\n\n    onChangeRoute = (route, timer) => {\n        setTimeout(() => {\n            console.log(route, \"clicked\");\n            if (this.checkLoggedIn()) {\n                let baseUrl = document.getElementById('baseUrl').defaultValue;\n                fetch(`${baseUrl}/teacherClasses?id=` + JSON.parse(sessionStorage.getItem('teacher')).id_number)\n                    .then(res => res.json()).then(data => {\n                        this.setState({\n                            classes: data,\n                            route\n                        })\n                    })\n                    .catch(e => console.log(e));\n            }\n        }, timer);\n    }\n\n    render() {\n        let { path } = this.props.match;\n        let classInfo = {\n            'students': this.state.students,\n            'className': this.state.selected_class\n        };\n        let rows = this.state.classes.map((cs) => {\n            return (\n\n                <div\n                    onClick={this.CheckClass}\n                    key={cs._id}\n                    data-class={cs.className}\n                    data-student={cs.students}\n                    id={`class:${cs._id}`}\n                    className={`cont-card`}\n                >\n                    <div data-class={cs.className} className=\"inner-cont-card  large button card-front\">\n                        <p data-class={cs.className} >{cs.className}</p>\n                        <i data-class={cs.className} className=\"far fa-paper-plane icons\"></i>\n                    </div>\n\n                    <div data-class={cs.className} className=\"panel card-back\">\n\n                        <div data-class={cs.className} className=\"inner-cont-card hub-info\">\n                            <i data-class={cs.className} className=\"far mb-3 fa-edit icons\"></i>\n                            <p data-class={cs.className}>Contains <br /> <span data-class={cs.className} className=\"number-span\">{cs.students.length}</span> <br /> Students</p>\n                        </div>\n\n                    </div>\n                </div>\n            )\n        });\n\n        return (\n             <>  \n             {this.state.route ? <Redirect to={this.state.route} /> : null}\n             {this.state.classes.length === 0 &&<section className=\"hero-unit\"><h1 style={{marginTop:'150px'}}> {\"You don't have any class yet.. \"}</h1> \n             <button style={{margin: '50px 0'}} className='my-button' > \n             <Link style={{color:'#eee', textDecoration:'none' }} to=\"/create\">Create a new class..</Link></button></section> } \n            \n             {this.state.classes.length !== 0 &&\n            <>\n                <Route path={`${path}/editClass`} component={() => <EditClass classInfo={classInfo} onChangeRoute={this.onChangeRoute} />} />\n                <Route path={`${path}/classHistory`} component={() => <History selected_class={this.state.selected_class} onChangeRoute={this.onChangeRoute} />} />\n                <Route path={`${path}/details`} component={() => <Details historyData={this.state.historyData} onChangeRoute={this.onChangeRoute} backToHistory={false} />} />\n                <Route path={`${path}`} exact >\n                    <div className=\" text-center\" >\n\n                        <section className=\"hero-unit\">\n                            <hgroup>\n                                <h2 className=\"select-class\">Select A Class </h2>\n                            </hgroup>\n\n                            <div className=\"flip-cards\">\n                                {rows}\n                            </div>\n                        </section>\n\n                    </div>\n                </Route>\n                <Route path={`${path}/classData`}>\n                    <div className=\"bg--white\">\n                    </div>\n                    <div className=\"container myCont\">\n\n                        <div class=\"loader\" hidden={!this.state.load}>\n                            <ul class=\"hexagon-container\">\n                                <li class=\"hexagon hex_1\"></li>\n                                <li class=\"hexagon hex_2\"></li>\n                                <li class=\"hexagon hex_3\"></li>\n                                <li class=\"hexagon hex_4\"></li>\n                                <li class=\"hexagon hex_5\"></li>\n                                <li class=\"hexagon hex_6\"></li>\n                                <li class=\"hexagon hex_7\"></li>\n                            </ul>\n                        </div>\n\n                        {/* buttons ,, top  */}\n                        <div className=\" divBtns btns\">\n                            <button hover-data=\"Back\"\n                                onClick={this.back} className=\"ma1 red-btn my-button\" hidden={this.state.load} >\n                                <i className=\"btn-icon far fa-arrow-alt-circle-left\"></i>\n                            </button>\n                            <div>\n                                <button hover-data=\"Edit Class\"\n                                    hidden={this.state.load} onClick={this.editClass} className=\" ma1 my-button\">\n                                    <i className=\"btn-icon fas fa-users-cog\"></i>\n                                </button>\n                                <button hover-data=\"Class History\"\n                                    hidden={this.state.load} onClick={this.showHistoryPage} className=\" ma1 my-button\">\n                                    <i className=\"btn-icon fas fa-history\"></i>\n                                </button>\n                            </div>\n                        </div>\n                            <h3 hidden={this.state.load} className=\"f2 mt4 font-lobster\">{this.state.selected_class}</h3>\n                        <div className=\"my-line2\" hidden={this.state.load}></div>\n                        {/* Face recognition */}\n                        <Row hidden={this.state.load}>\n                            <Col xs={12}>\n                                <button hidden={this.state.showUploadBtn} onClick={this.setShowBtn} className=\"my-button mt-4\">Check Attendence</button>\n                                <div hidden={!this.state.showUploadBtn}>\n\n                                    <p hidden={!this.state.showImage} className=\"mt-5 f3 b i upload-text\">Upload one or more image to take the attendance, Then click on <span className='red f3'>'Done'</span> Button.</p>\n\n                                    <label htmlFor=\"file2\" className=\"mt-3 my-button f4 pointer\">{(this.state.ids.length === 0) ? 'Upload An Image ' : 'Upload Another Image '} <i class=\" fas fa-cloud-upload-alt\"></i>   </label>\n                                    <input type=\"file\" hidden onChange={this.checkAttendence} accept=\"image/*\" id=\"file2\" className=\"form-file mt-4 \" required />\n                                    <br />\n\n                                    {/* Image will display the uploaded image , we use it to draw it on canvas . */}\n                                    <img hidden id=\"person\" src={this.state.file} alt=\"Person\" />\n\n                                    {/* Canvas will draw the image , rectangles and names . */}\n                                    <canvas id=\"canvas\" width={this.state.width} height={this.state.height} hidden></canvas>\n\n                                    {/* The final result will be shown on the img below , that we can edit it's width and height . */}\n                                    <img className=\"img-thumbnail mt-4\" src={this.state.file || noImage} alt=\"Person\" width=\"300\" height='300' hidden={this.state.showImage} />\n                                    <br />\n\n                                    <div className=\"table-buttons2\">\n                                        <button hidden={this.state.showImage} onClick={this.clear} className=\"my-button grow red-btn\"><i class=\"fas fa-trash-alt\"></i></button>\n                                        <button hidden={this.state.showImage} className=\"my-button  grow\"><a href={`${this.state.file}`} download></a> <i class=\"fas fa-download\"></i> </button>\n                                        <button hidden={this.state.showImage} onClick={this.sendHistoryData} disabled={this.state.doneDisable} className=\"my-button grn-btn grow \">Done</button>\n                                    </div>\n                                </div>\n                            </Col>\n                        </Row>\n                        <div className=\"my-line\" hidden={this.state.load}></div>\n                        {/* Student table */}\n                        <Row hidden={this.state.load} className=\"mt5\">\n                            <Col xs={12} >\n                                <h3 className=\"mt-2 table-header font-acme\">Students enrolled this course</h3>\n                                <StudentsTable students={this.state.showStudents} />\n                                <div className=\"table-buttons\">\n                                    <button onClick={this.showAllStudents} className=\"my-button grow\">All Students</button>\n                                    <button onClick={this.showAttendStudents} className=\"my-button grn-btn grow\">Attendance Students</button>\n                                    <button onClick={this.showAbcentStudents} className=\"my-button grow red-btn\">Absence Students</button>\n                                </div>\n                            </Col>\n                        </Row>\n                    </div>\n                    </Route>\n                    \n                    </>\n             }\n                 </>\n                \n            );\n    }\n}\nexport default MyClasses;\n"]},"metadata":{},"sourceType":"module"}